<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>Add New Movie</title>
    <style>
        body { font-family: sans-serif; margin: 2em; max-width: 600px; }
        form { display: flex; flex-direction: column; gap: 1em; }
        .form-group { display: flex; flex-direction: column; }
        label { margin-bottom: 0.5em; font-weight: bold; }
        input, textarea { padding: 0.5em; border: 1px solid #ccc; border-radius: 4px; }
        button { background-color: #007bff; color: white; border: none; padding: 0.75em; border-radius: 4px; cursor: pointer; font-size: 1em; }
    </style>
</head>
<body>
<p><a href="/">&laquo; ëª©ë¡ìœ¼ë¡œ ëŒì•„ê°€ê¸°</a></p>
<hr>

<h1>ğŸ“ ìƒˆ ì˜í™” ì •ë³´ ì¶”ê°€í•˜ê¸°</h1>

<form id="add-movie-form">
    <div class="form-group">
        <label for="id">ì˜í™” ID</label>
        <input type="number" id="id" required>
    </div>
    <div class="form-group">
        <label for="title">ì œëª©</label>
        <input type="text" id="title" required>
    </div>
    <div class="form-group">
        <label for="releaseYear">ì¶œì‹œë…„ë„</label>
        <input type="number" id="releaseYear" required>
    </div>
    <div class="form-group">
        <label for="posterPath">í¬ìŠ¤í„° ê²½ë¡œ</label>
        <input type="text" id="posterPath" placeholder="/abcdef.jpg">
    </div>
    <div class="form-group">
        <label for="overview">ì¤„ê±°ë¦¬</label>
        <textarea id="overview" rows="5"></textarea>
    </div>
    <button type="submit">ì €ì¥í•˜ê¸°</button>
</form>

<script>
    const form = document.getElementById('add-movie-form');

    form.addEventListener('submit', (event) => {
        // 1. formì˜ ê¸°ë³¸ ì œì¶œ ë™ì‘(ìƒˆë¡œê³ ì¹¨)ì„ ë§‰ìŠµë‹ˆë‹¤.
        event.preventDefault();

        // 2. ê° input íƒœê·¸ì—ì„œ ì‚¬ìš©ìê°€ ì…ë ¥í•œ ê°’ì„ ê°€ì ¸ì˜µë‹ˆë‹¤.
        const movieData = {
            id: document.getElementById('id').value,
            title: document.getElementById('title').value,
            releaseYear: document.getElementById('releaseYear').value,
            posterPath: document.getElementById('posterPath').value,
            overview: document.getElementById('overview').value
        };

        // 3. fetchë¥¼ ì´ìš©í•´ ì„œë²„ì— POST ìš”ì²­ì„ ë³´ëƒ…ë‹ˆë‹¤.
        fetch('/api/movies', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json', // ë³´ë‚´ëŠ” ë°ì´í„°ê°€ JSON í˜•ì‹ì„ì„ ì•Œë ¤ì¤ë‹ˆë‹¤.
            },
            body: JSON.stringify(movieData), // JavaScript ê°ì²´ë¥¼ JSON ë¬¸ìì—´ë¡œ ë³€í™˜í•©ë‹ˆë‹¤.
        })
            .then(response => {
                if (response.ok) {
                    alert('ìƒˆ ì˜í™”ê°€ ì„±ê³µì ìœ¼ë¡œ ì¶”ê°€ë˜ì—ˆìŠµë‹ˆë‹¤.');
                    window.location.href = '/'; // ì €ì¥ í›„ ëª©ë¡ í˜ì´ì§€ë¡œ ì´ë™
                } else {
                    alert('ì˜í™” ì¶”ê°€ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.');
                }
            })
            .catch(error => console.error('ì˜í™” ì¶”ê°€ ì¤‘ ì˜¤ë¥˜ ë°œìƒ:', error));
    });
</script>
</body>
</html>